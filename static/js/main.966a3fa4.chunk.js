(this["webpackJsonphome-climate-monitor"]=this["webpackJsonphome-climate-monitor"]||[]).push([[0],{31:function(e,t,a){},32:function(e,t,a){},57:function(e,t,a){"use strict";a.r(t);var r=a(2),n=a.n(r),i=a(23),s=a.n(i),c=(a(31),a(32),a(1)),o=a.n(c),u=a(4),d=a(5),l=a(6),p=a(9),h=a(8),m=a(7),v=(a(34),a(24)),b=a.n(v),j=a(0),f=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"formatDate",value:function(e){var t=navigator.language;return new Intl.DateTimeFormat(t,{dateStyle:"short",timeStyle:"short",hour12:!1}).format(new Date(e))}},{key:"render",value:function(){return Object(j.jsx)("div",{className:"col s12 m5 l3",children:Object(j.jsx)("div",{className:"card blue-grey darken-4",children:Object(j.jsx)("div",{className:"card blue-grey darken-4",children:Object(j.jsxs)("div",{className:"card-content white-text",children:[Object(j.jsx)("span",{className:"card-span",children:this.props.title?this.props.title:"Title"}),Object(j.jsx)("span",{className:"card-title",children:this.props.temperature?this.props.temperature+"\xb0C":"Temperature Error"}),Object(j.jsx)("p",{className:"card-span",children:this.props.humidity?this.props.humidity+"%":"Humdity Error"}),Object(j.jsx)("div",{className:"divider"}),Object(j.jsx)("span",{className:"card-span",children:this.props.date?this.formatDate(this.props.date):"Date Error"})]})})})})}}]),a}(r.Component),x=f,y=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(d.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).getDeviceDescription=function(t){var a=e.props.devices.filter((function(e){return t===e.serial}));return 0!==a.length?a[0].description:""},e.deviceCard=function(){if(null!==e.props.readings&&void 0!==e.props.readings[0])return e.props.readings.map((function(t){return void 0!==t[0]?Object(j.jsx)(x,{title:e.getDeviceDescription(t[0].serial),humidity:t[0].humidity,temperature:t[0].temperature,date:t[0].timestamp},t[0].serial):""}))},e}return Object(l.a)(a,[{key:"render",value:function(){return Object(j.jsx)("div",{className:"row",children:void 0!==this.props.devices?this.deviceCard():""})}}]),a}(r.Component),g=y,O=a(25),D=a.n(O),k=a(26),w=a.n(k)()(D.a),N=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(d.a)(this,a),(r=t.call(this,e)).state={labels:[],label:null,xData:[],yData:[],dateData:[],chartData:{},options:{}},r}return Object(l.a)(a,[{key:"getMinOfArray",value:function(e){return Math.min.apply(null,e)}},{key:"getMaxOfArray",value:function(e){return Math.max.apply(null,e)}},{key:"componentDidMount",value:function(){var e=Math.round(this.getMinOfArray(this.props.yDataLeft)-1),t=Math.round(this.getMaxOfArray(this.props.yDataLeft)+1),a=Math.round(this.getMinOfArray(this.props.yDataRight)-1),r=Math.round(this.getMaxOfArray(this.props.yDataRight)+1);this.setState({options:{color:"#FFF",elements:{point:{radius:0}},responsive:!0,scales:{y:{type:"linear",position:"left",grid:{color:"rgba(255, 255, 255, 0.1)"},min:e,max:t,ticks:{display:!0,stepSize:.5,color:"rgba(255, 255, 255, 0.7)"}},y1:{type:"linear",position:"right",grid:{drawOnChartArea:!1},min:a,max:r,ticks:{display:!0,stepSize:.5,color:"rgba(255, 255, 255, 0.7)"}},x:{grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{display:!0,color:"rgba(255, 255, 255, 0.7)"}}}}})}},{key:"render",value:function(){return Object(j.jsx)(w,{data:[{x:this.props.xData,y:this.props.yDataLeft,name:"Temperature",mode:"lines",hovertemplate:" %{y:.1f}&deg;C"},{x:this.props.xData,y:this.props.yDataRight,yaxis:"y2",name:"Humidity",mode:"lines",hovertemplate:" %{y:.0f}%"}],layout:{margin:{t:90,b:90,l:70,r:70,pad:10},autosize:!0,legend:{orientation:"h",yanchor:"bottom",y:1.12,xanchor:"right",x:1},xaxis:{title:{text:"Date/Time"},autorange:"false",type:"date"},yaxis:{title:"Temperature (&deg;C)",automargin:!0},yaxis2:{title:"Humidity (%)",range:[0,100],overlaying:"y",side:"right",automargin:!0},hovermode:"x unified"},useResizeHandler:!0,style:{maxWidth:"100%",height:"100%"}})}}]),a}(n.a.Component),S=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(d.a)(this,a),r=t.call(this,e),Array.isArray(r.props.data)&&(r.state={data:r.props.data,temperatures:r.props.data.map((function(e){return e.temperature})),humidity:r.props.data.map((function(e){return e.humidity})),timestamps:r.props.data.map((function(e){return e.timestamp}))}),r}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e,t){if(e.data!==this.props.data&&Array.isArray(this.props.data)){var a=this.props.data.map((function(e){return e.temperature})),r=this.props.data.map((function(e){return e.humidity})),n=this.props.data.map((function(e){return e.timestamp}));this.setState({temperatures:a,humidity:r,timestamps:n})}}},{key:"render",value:function(){return Object(j.jsx)("div",{className:"row",children:Object(j.jsx)("div",{className:"col s12 m12 l12",children:Object(j.jsxs)("div",{className:"card blue-grey darken-1",children:[Object(j.jsx)("div",{className:"card-title white-text center-align hide-on-large-only",children:this.props.title}),Object(j.jsx)("div",{className:"card-content white-text",children:null!==this.state?Object(j.jsx)(N,{labelLeft:"Temperature (\u2103)",labelRight:"Humidity (%)",xData:this.state.timestamps,yDataLeft:this.state.temperatures,yDataRight:this.state.humidity,title:" "}):""})]})})})}}]),a}(r.Component),C=a(12),_=a.n(C),M="https://home-climate-monitor.herokuapp.com",A=function(){var e=Object(u.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(M,"/device/"),e.next=3,L(t);case 3:return a=e.sent,e.abrupt("return",a.hasOwnProperty("data")?a.data:[]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function L(e){return E.apply(this,arguments)}function E(){return E=Object(u.a)(o.a.mark((function e(t){var a,r=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:4e3,e.prev=1,e.next=4,_()({method:"get",url:t,timeout:a});case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return","Error");case 10:case"end":return e.stop()}}),e,null,[[1,7]])}))),E.apply(this,arguments)}var H=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(M,"/data/").concat(t,"/last"),e.next=3,I(a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,r,n,i,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:new Date,r=s.length>2&&void 0!==s[2]?s[2]:new Date,n="".concat(M,"/data/").concat(t,"?start=").concat(a.replace("Z",""),"&end=").concat(r.replace("Z","")),e.next=5,I(n);case 5:return i=e.sent,e.abrupt("return",i.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function I(e){return R.apply(this,arguments)}function R(){return R=Object(u.a)(o.a.mark((function e(t){var a,r=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:4e3,e.prev=1,e.next=4,_()({method:"get",url:t,timeout:a});case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return","Error");case 10:case"end":return e.stop()}}),e,null,[[1,7]])}))),R.apply(this,arguments)}var B=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(d.a)(this,a),(r=t.call(this,e)).handleChangeDevice=r.handleChangeDevice.bind(Object(p.a)(r)),r.handleBurger=r.handleBurger.bind(Object(p.a)(r)),r.state={devices:null,last_readings:[],selected_device:null,device_data:null},r}return Object(l.a)(a,[{key:"handleBurger",value:function(e){console.log("burger")}},{key:"handleChangeDevice",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target.text!==this.state.selected_device.description){e.next=2;break}return e.abrupt("return");case 2:if(0===(a=this.state.devices.filter((function(e){return e.description===t.target.text}))).length){e.next=9;break}return a=a[0],e.next=7,this.getDataLast24Hours(a.serial);case 7:r=e.sent,this.setState({selected_device:a,device_data:r});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDataLast24Hours",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(null!=t){e.next=4;break}return e.abrupt("return");case 4:return(a=new Date).setDate(a.getDate()-1),(r=new Date).setDate(r.getDate()+1),e.abrupt("return",T(t,a.toISOString(),r.toISOString()));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t,a,r,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".datepicker"),t={defaultDate:new Date,setDefaultDate:!0};b.a.Datepicker.init(e,t)})),e.next=3,A();case 3:if(t=e.sent,this.setState({devices:t}),void 0===this.state.devices){e.next=20;break}return this.setState({selected_device:this.state.devices[0]}),e.next=9,Promise.all(this.state.devices.map((function(e){return H(e.serial)})));case 9:if(a=e.sent,this.setState({last_readings:a}),(r=new Date).setDate(r.getDate()-1),(n=new Date).setDate(n.getDate()+1),void 0===this.state.selected_device){e.next=20;break}return e.next=18,T(this.state.selected_device.serial,r.toISOString(),n.toISOString());case 18:void 0!==(i=e.sent)&&this.setState({device_data:i});case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(j.jsx)("div",{children:Object(j.jsxs)("div",{className:"row margin-none",children:[Object(j.jsxs)("div",{className:"hide-on-med-and-up center-align",children:[Object(j.jsx)("h1",{className:"white-text margin-none header-title",children:"Dashboard"}),Object(j.jsxs)("div",{className:"burger",onClick:this.handleBurger,children:[Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{})]}),Object(j.jsx)("ul",{className:"mobileNav",children:null!=this.state.devices?this.state.devices.map((function(t){return Object(j.jsx)("li",{children:Object(j.jsx)("a",{onClick:e.handleChangeDevice,className:"waves-effect waves-light btn grey darken-2 sidebar-links",children:t.description})},t.serial)})):""})]}),Object(j.jsx)("div",{className:"col s12 m4 l2 blue-grey darken-3 min-height-100 hide-on-med-and-down",children:Object(j.jsxs)("div",{className:"section white-text text-center",children:[Object(j.jsx)("h1",{className:"white-text sidebar-title",children:"Graphs"}),Object(j.jsx)("div",{className:"divider"}),Object(j.jsx)("input",{type:"text",className:"datepicker datepicker-override"}),Object(j.jsx)("ul",{children:null!=this.state.devices?this.state.devices.map((function(t){return Object(j.jsx)("li",{children:Object(j.jsx)("a",{onClick:e.handleChangeDevice,className:"waves-effect waves-light btn grey darken-2 sidebar-links",children:t.description})},t.serial)})):""})]})}),Object(j.jsxs)("div",{className:"col s12 m12 l10 blue-grey darken-2 min-height-100vh",children:[null!=this.state.last_readings?Object(j.jsx)(g,{readings:this.state.last_readings,devices:this.state.devices}):"",null!=this.state.device_data&&void 0!==this.state.device_data&&this.state.device_data.length>1?Object(j.jsx)(S,{data:this.state.device_data,title:this.state.selected_device.description}):""]})]})})}}]),a}(r.Component),z=B;var F=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(z,{})})};s.a.render(Object(j.jsx)(n.a.StrictMode,{children:Object(j.jsx)(F,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.966a3fa4.chunk.js.map