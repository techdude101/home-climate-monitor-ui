{"version":3,"sources":["components/card.jsx","components/cards.jsx","components/line-chart.jsx","components/graph.jsx","utils/input-validation.js","utils/constants.js","utils/device.js","components/add-device.jsx","utils/device-data.js","components/container.jsx","App.js","index.js"],"names":["Card","props","handleClick","bind","d","Date","UTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","reading","this","date","readingUTC","dateToUTC","now","e","clickHandler","title","locale","navigator","language","Intl","DateTimeFormat","dateStyle","timeStyle","hour12","format","className","selected","onClick","lastReadingWarning","temperature","humidity","formatDate","Component","Cards","getDeviceDescription","serial","result","devices","filter","length","description","deviceCard","readings","undefined","map","device","timestamp","selectedDevice","Plot","createPlotlyComponent","Plotly","LineChart","state","labels","label","xData","yData","dateData","chartData","options","numArray","Math","min","apply","max","minY1","floor","getMinOfArray","yDataLeft","maxY1","ceil","getMaxOfArray","minY2","round","yDataRight","maxY2","setState","color","elements","point","radius","responsive","scales","y","type","position","grid","ticks","display","stepSize","y1","drawOnChartArea","x","previousProps","previousState","data","name","mode","hovertemplate","yaxis","layout","margin","t","b","l","r","pad","autosize","legend","orientation","yanchor","xanchor","xaxis","text","autorange","automargin","range","yaxis2","overlaying","side","hovermode","useResizeHandler","style","maxWidth","height","React","Graph","Array","isArray","temperatures","timestamps","labelLeft","labelRight","isInputValid","value","minLength","regex","test","URL","getDevices","a","url","CONSTANTS","fetchData","hasOwnProperty","addDevice","key","headers","axios","post","timeout","method","AddDevice","handleChange","handleChangeNumber","handleSubmit","addingDevice","addButtonDisabled","keyError","descriptionError","addDeviceError","new_device_key","new_device_serial","maxSerialNumber","forEach","M","updateTextFields","keyIsValid","descriptionIsValid","id","target","validity","valid","isFormValid","defaultValue","preventDefault","console","log","response","onSubmit","required","onChange","htmlFor","maxLength","getLastReading","device_serial","getData","start","end","replace","Container","handleChangeDevice","handleBurger","toggleAddDevice","displayGraphs","last_readings","selected_device","device_data","add_device","innerText","toLowerCase","new_selected_device","getDataLast24Hours","start_date","setDate","getDate","end_date","toISOString","document","addEventListener","elems","querySelectorAll","defaultDate","setDefaultDate","Datepicker","init","Promise","all","displayCards","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.e4b7d766.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\n\r\n\r\nclass Card extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleClick = this.handleClick.bind(this);\r\n  }\r\n  dateToUTC(d) {\r\n    return Date.UTC(d.getUTCFullYear(), d.getUTCMonth(), d.getUTCDate(), d.getUTCHours(), d.getUTCMinutes(), d.getUTCSeconds());\r\n  }\r\n\r\n  // Check if last reading was over 1 hour ago\r\n  lastReadingWarning() {\r\n    const reading = new Date(this.props.date);\r\n    const readingUTC = this.dateToUTC(reading);\r\n    const now = new Date();\r\n    const nowUTC = this.dateToUTC(now);\r\n    const difference = (nowUTC - readingUTC) / 1000; // seconds\r\n    \r\n    // 60 seconds * 60 minutes\r\n    if (difference > (60 * 60)) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  handleClick(e) {\r\n    this.props.clickHandler(this.props.title);\r\n  }\r\n\r\n  formatDate(date) {\r\n    // Get user locale from browser\r\n    const locale = navigator.language;\r\n\r\n    return new Intl.DateTimeFormat(locale, { dateStyle: 'short', timeStyle: 'short', hour12: false }).format(new Date(date));\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"col s12 m5 l3\">\r\n        <div className={`card card-pointer blue-grey ${this.props.selected ? \"darken-3\" : \"darken-4\"}`} onClick={this.handleClick}>\r\n          <div className={`card grey ${this.props.selected ? \"darken-3\" : \"darken-4\"}`}>\r\n            <div className=\"card-content white-text\">\r\n              <span className=\"card-span\">{this.props.title ? this.props.title : \"Title\"}</span>\r\n              {this.lastReadingWarning() ? <span className=\"card-warning-icon\"><i className=\"material-icons yellow-text\">warning</i></span> : null }\r\n              <span className=\"card-title\">{this.props.temperature ? this.props.temperature + \"\\u00b0C\" : \"Temperature Error\"}</span>\r\n              <p className=\"card-span\">{this.props.humidity ? this.props.humidity + \"%\" : <br />}</p>\r\n              <div className=\"divider\"></div>\r\n              <span className={`card-span ${this.lastReadingWarning() && \"red-text\"}`}>{this.props.date ? this.formatDate(this.props.date) : \"Date Error\"}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Card;","import React, { Component } from 'react';\r\n\r\nimport Card from './card';\r\n\r\nclass Cards extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.clickHandler = this.clickHandler.bind(this);\r\n  }\r\n\r\n  clickHandler(e) {\r\n    this.props.clickHandler(e);\r\n  }\r\n\r\n  getDeviceDescription = (serial) => {\r\n    const result = this.props.devices.filter(d => serial === d.serial);\r\n    // return result[0].description;\r\n    return result.length !== 0 ? result[0].description : \"\";\r\n  }\r\n\r\n  deviceCard = () => {\r\n    if (this.props.readings === null) return;\r\n    if (this.props.readings[0] === undefined) return;\r\n    return  this.props.readings.map((device) => {\r\n      if (device[0] !== undefined) {\r\n      return <Card\r\n      key={device[0].serial}\r\n      title={this.getDeviceDescription(device[0].serial)}\r\n      humidity={device[0].humidity}\r\n      temperature={device[0].temperature}\r\n      date={device[0].timestamp} \r\n      clickHandler={this.clickHandler} \r\n      selected={this.props.selectedDevice === this.getDeviceDescription(device[0].serial)} />\r\n      } else { return \"\" }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"row\">\r\n        {this.props.devices !== undefined ? this.deviceCard() : \"\"}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Cards;","import React from 'react';\r\nimport Plotly from \"plotly.js-basic-dist\";\r\n\r\nimport createPlotlyComponent from \"react-plotly.js/factory\";\r\nconst Plot = createPlotlyComponent(Plotly);\r\n\r\nclass LineChart extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      labels: [],\r\n      label: null,\r\n      xData: [],\r\n      yData: [],\r\n      dateData: [],\r\n      chartData: {},\r\n      options: {},\r\n    }\r\n  }\r\n\r\n  getMinOfArray(numArray) {\r\n    return Math.min.apply(null, numArray);\r\n  }\r\n\r\n  getMaxOfArray(numArray) {\r\n    return Math.max.apply(null, numArray);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const minY1 = Math.floor(this.getMinOfArray(this.props.yDataLeft));\r\n    const maxY1 = Math.ceil(this.getMaxOfArray(this.props.yDataLeft));\r\n\r\n    const minY2 = Math.round(this.getMinOfArray(this.props.yDataRight) - 1);\r\n    const maxY2 = Math.round(this.getMaxOfArray(this.props.yDataRight) + 1);\r\n\r\n    this.setState({\r\n      minY1: minY1,\r\n      maxY1: maxY1,\r\n      options: {\r\n        color: '#FFF',\r\n        elements: {\r\n          point: { radius: 0 }\r\n        },\r\n        responsive: true,\r\n        scales: {\r\n          y: {\r\n            type: 'linear',\r\n            position: 'left',\r\n            grid: {\r\n              color: 'rgba(255, 255, 255, 0.1)',\r\n            },\r\n            min: minY1,\r\n            max: maxY1,\r\n            ticks: {\r\n              display: true,\r\n              stepSize: 0.5,\r\n              color: 'rgba(255, 255, 255, 0.7)',\r\n            }\r\n          },\r\n          y1: {\r\n            type: 'linear',\r\n            position: 'right',\r\n            grid: {\r\n              drawOnChartArea: false, // only want the grid lines for one axis to show up\r\n            },\r\n            min: minY2,\r\n            max: maxY2,\r\n            ticks: {\r\n              display: true,\r\n              stepSize: 1,\r\n              color: 'rgba(255, 255, 255, 0.7)',\r\n            }\r\n          },\r\n          x: {\r\n            grid: {\r\n              color: 'rgba(255, 255, 255, 0.1)',\r\n            },\r\n            ticks: {\r\n              display: true,\r\n              color: 'rgba(255, 255, 255, 0.7)',\r\n            }\r\n          }\r\n        },\r\n      },\r\n    });\r\n  }\r\n\r\n  componentDidUpdate(previousProps, previousState) {\r\n    if (previousProps.yDataLeft !== this.props.yDataLeft) {\r\n      const minY1 = Math.floor(this.getMinOfArray(this.props.yDataLeft));\r\n      const maxY1 = Math.ceil(this.getMaxOfArray(this.props.yDataLeft));\r\n      this.setState({\r\n        minY1: minY1,\r\n        maxY1: maxY1\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n        <Plot\r\n          data={[\r\n            {\r\n              x: this.props.xData,\r\n              y: this.props.yDataLeft,\r\n              name: \"Temperature\",\r\n              mode: 'lines',\r\n              hovertemplate: ' %{y:.1f}&deg;C',\r\n            },\r\n            {\r\n              x: this.props.xData,\r\n              y: this.props.yDataRight,\r\n              yaxis: \"y2\",\r\n              name: \"Humidity\",\r\n              mode: 'lines',\r\n              hovertemplate: ' %{y:.0f}%',\r\n            },\r\n          ]}\r\n          layout={{\r\n            margin: {\r\n              t: 90,\r\n              b: 90,\r\n              l: 70,\r\n              r: 70,\r\n              pad: 10\r\n            },\r\n\r\n            autosize: true,\r\n            legend: {\r\n              orientation: \"h\",\r\n              yanchor: \"bottom\",\r\n              y: 1.12,\r\n              xanchor: \"right\",\r\n              x: 1,\r\n            },\r\n            xaxis: {\r\n              title: { text: 'Date/Time' },\r\n              autorange: \"false\",\r\n              type: 'date',\r\n            },\r\n            yaxis: { title: 'Temperature (&deg;C)', automargin: true, range: [this.state.minY1, this.state.maxY1] },\r\n            yaxis2: {\r\n              title: 'Humidity (%)',\r\n              range: [0, 100],\r\n              overlaying: 'y',\r\n              side: 'right',\r\n              automargin: true,\r\n            },\r\n            hovermode: \"x unified\",\r\n          }}\r\n          useResizeHandler={true}\r\n          style={{ maxWidth: \"100%\", height: \"100%\" }}\r\n        />\r\n    )\r\n  }\r\n}\r\n\r\nexport default LineChart;","import React, { Component } from 'react';\r\n\r\nimport LineChart from './line-chart';\r\n\r\nclass Graph extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    if (Array.isArray(this.props.data)) {\r\n      this.state = {\r\n        data: this.props.data,\r\n        temperatures: this.props.data.map(d => d.temperature),\r\n        humidity: this.props.data.map(d => d.humidity),\r\n        timestamps: this.props.data.map(d => d.timestamp)\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(previousProps, previousState) {\r\n    if (previousProps.data !== this.props.data && Array.isArray(this.props.data)) {\r\n      const temperatures = this.props.data.map(d => d.temperature);\r\n      const humidity = this.props.data.map(d => d.humidity);\r\n      const timestamps = this.props.data.map(d => d.timestamp);\r\n      this.setState({\r\n        temperatures: temperatures,\r\n        humidity: humidity,\r\n        timestamps: timestamps\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"row\">\r\n        <div className=\"col s12 m12 l12\">\r\n          <div className=\"card blue-grey darken-1\">\r\n            <div className=\"card-title white-text center-align hide-on-large-only\">\r\n              {this.props.title}\r\n            </div>\r\n            <div className=\"card-content white-text\">\r\n              {this.state !== null ? \r\n              <LineChart\r\n                labelLeft=\"Temperature (℃)\"\r\n                labelRight=\"Humidity (%)\"\r\n                xData={this.state.timestamps}\r\n                yDataLeft={this.state.temperatures}\r\n                yDataRight={this.state.humidity}\r\n                title={\" \"}\r\n              /> : \"\"}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Graph;","export const isInputValid = (value, minLength=3) => {\n  // Allow things like Seán with unicode characters\n  // Disallow things like <script>alert;\n  const regex = /[!\"#$%&'()*+,.£\\\\/:;<=>?@[\\]^_`{|}~]/;\n\n  if (value.length < minLength || regex.test(value) === true) {\n    return false;\n  }\n  return true;\n};","export const URL = 'https://home-climate-monitor.herokuapp.com';","import axios from 'axios';\r\nimport * as CONSTANTS from './constants';\r\n\r\nexport const getDevices = async () => {\r\n  const url = `${CONSTANTS.URL}/device/`;\r\n  const data = await fetchData(url);\r\n  return data.hasOwnProperty('data') ? data.data : [];\r\n};\r\n\r\nexport const addDevice = async (serial, description, key) => {\r\n  const url = `${CONSTANTS.URL}/device/create`;\r\n  const headers = {\r\n    'Content-Type': 'application/json',\r\n    'X-API-KEY': key\r\n  }\r\n  try {\r\n    return await axios.post(url, { serial: serial, description: description }, { headers: headers }, { timeout: 10_000 });\r\n  } catch {\r\n    return \"Error\";\r\n  }\r\n};\r\n\r\nexport async function fetchData(url, timeout=10_000) {\r\n  try {\r\n    return await axios({\r\n      method: 'get',\r\n      url: url,\r\n      timeout: timeout,\r\n    });\r\n  } catch {\r\n    return \"Error\";\r\n  }\r\n}\r\n","import React from 'react';\nimport M from 'materialize-css/dist/js/materialize.min.js';\nimport { isInputValid } from '../utils/input-validation';\nimport { getDevices, addDevice } from '../utils/device';\n\nclass AddDevice extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleChangeNumber = this.handleChangeNumber.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    \n    this.state = {\n      addingDevice: false,\n      addButtonDisabled: true,\n      serial: 1,\n      description: '',\n      key: '',\n      keyError: false,\n      descriptionError: false,\n      addDeviceError: false,\n      new_device_key: null,\n      new_device_serial: null\n    }\n  }\n\n  async componentDidMount() {\n    const devices = await getDevices();\n    let maxSerialNumber = 0;\n\n    // Loop over devices to get the last serial number\n    devices.forEach((device) => {\n      maxSerialNumber = Math.max(device.serial, maxSerialNumber);\n    });\n    this.setState({serial: maxSerialNumber + 1})\n\n    M.updateTextFields(); // Fixes overlapping label issue\n  }\n\n  isFormValid() {\n    const key = this.state.key;\n    const description = this.state.description;\n\n    const keyIsValid = isInputValid(key);\n    const descriptionIsValid = isInputValid(description);\n    this.setState({ descriptionError: !descriptionIsValid })\n    this.setState({ keyError: !keyIsValid })\n\n    return keyIsValid && descriptionIsValid;\n  }\n\n  handleChange(e) {\n    const id = e.target.id;\n    const value = e.target.value;\n\n    if (isInputValid(value, 3) && e.target.validity.valid) {\n      if (id === 'description') this.setState({ description: value, descriptionError: false })\n      if (id === 'pass_or_key') this.setState({ key: value, keyError: false })\n    } else {\n      if (id === 'description') {\n        this.setState({ description: value, descriptionError: true })\n      }\n      if (id === 'pass_or_key') this.setState({ key: value, keyError: true })\n    }\n    this.setState({ addButtonDisabled: this.state.keyError || this.state.descriptionError });\n  }\n\n  handleChangeNumber(e) {\n    const id = e.target.id;\n    const value = e.target.value;\n\n    if (!e.target.validity.valid) {\n      // Set to previous valid value if invalid\n      e.target.value = e.target.defaultValue;\n    } else {\n      if (id === 'serial_number') this.setState({ serial: value })\n      this.setState({ addButtonDisabled: this.isFormValid() });\n    }\n  }\n\n  async handleSubmit(e) {\n    e.preventDefault();\n    console.log(\"submit\");\n    const formIsValid = this.isFormValid(e);\n    if (formIsValid === false) {\n      return;\n    }\n    // Disable button after submitting the form\n    this.setState({ addButtonDisabled: true });\n\n    const response = await addDevice(this.state.serial, this.state.description, this.state.key);\n    console.log(response);\n    if (response.hasOwnProperty('data') && response.data.hasOwnProperty('key') && response.data.hasOwnProperty('serial')) {\n      this.setState({\n        new_device_key: response.data.key,\n        new_device_serial: response.data.serial\n      });\n    } else {\n      this.setState({ addDeviceError: true })\n    }\n    // Check if device was added successfully\n    // const devices = await getDevices();\n    return false;\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <h4 className=\"white-text\">Add a Device</h4>\n        <form className=\"col s12\" onSubmit={this.handleSubmit}>\n          <div className=\"row\">\n            <div className=\"row\">\n              <div className=\"input-field col s12\">\n                <input name=\"serial_number\" id=\"serial_number\" type=\"number\" value={this.state.serial} min=\"1\" max=\"100\" className=\"validate white-text\" required onChange={this.handleChangeNumber} />\n                <label htmlFor=\"serial_number\">Device Serial Number</label>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"input-field col s12\">\n                <input name=\"description\" id=\"description\" type=\"text\" className=\"validate white-text\" maxLength=\"50\" required value={this.state.description} onChange={this.handleChange} />\n                <label htmlFor=\"description\">Device Description</label>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"input-field col s12\">\n                <input name=\"pass_or_key\" id=\"pass_or_key\" type=\"text\" className=\"validate white-text\" required value={this.state.key} onChange={this.handleChange} />\n                <label htmlFor=\"pass_or_key\">API Key</label>\n              </div>\n            </div>\n            <div className=\"row\">\n              {this.state.keyError || this.state.descriptionError ?\n                <div className=\"input-field col s12 red\">\n                  <p>Error - invalid description or API key</p> </div>\n                : null\n              }\n            </div>\n            <div className=\"row\">\n              {this.state.addDeviceError ?\n                <div className=\"input-field col s12 red\">\n                  <p>Error adding device</p></div>\n                : null\n              }\n            </div>\n            <div className=\"row\">\n              {this.state.new_device_key ?\n                <div className=\"input-field col s12\">\n                  <p>API key for device serial #{this.state.new_device_serial} = {this.state.new_device_key}</p> </div>\n                : null\n              }\n            </div>\n          </div>\n          <div>\n            <button className=\"waves-effect waves-light red btn-flat form-buttons\">\n              Cancel\n            </button>\n            <button type=\"submit\" className={`waves-effect waves-light green btn-flat form-buttons ${this.state.addButtonDisabled ? \"disabled\" : null}`} >\n              Add Device\n            </button>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport default AddDevice;","import axios from 'axios';\r\nimport * as CONSTANTS from './constants';\r\n\r\nexport const getLastReading = async (device_serial) => {\r\n  const url = `${CONSTANTS.URL}/data/${device_serial}/last`;\r\n  const data = await fetchData(url);\r\n  // console.log(data)\r\n  return data.data;\r\n};\r\n\r\nexport const getData = async (device_serial, start=new Date(), end=new Date()) => {\r\n  const url = `${CONSTANTS.URL}/data/${device_serial}?start=${start.replace('Z', '')}&end=${end.replace('Z', '')}`;\r\n  const data = await fetchData(url);\r\n  // console.log(data)\r\n  return data.data;\r\n};\r\n\r\nexport async function fetchData(url, timeout=10000) {\r\n  try {\r\n    return await axios({\r\n      method: 'get',\r\n      url: url,\r\n      timeout: timeout,\r\n    });\r\n  } catch {\r\n    return \"Error\";\r\n  }\r\n}","import React, { Component } from 'react';\r\nimport 'materialize-css/dist/css/materialize.min.css';\r\nimport M from 'materialize-css/dist/js/materialize.min.js';\r\n\r\nimport Cards from './cards';\r\nimport Graph from './graph';\r\nimport AddDevice from './add-device';\r\n\r\nimport { getDevices } from '../utils/device'\r\nimport { getLastReading, getData } from '../utils/device-data';\r\n\r\nclass Container extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleChangeDevice = this.handleChangeDevice.bind(this);\r\n    this.handleBurger = this.handleBurger.bind(this);\r\n    this.toggleAddDevice = this.toggleAddDevice.bind(this);\r\n    this.displayGraphs = this.displayGraphs.bind(this);\r\n    this.state = {\r\n      devices: null,\r\n      last_readings: [],\r\n      selected_device: null,\r\n      device_data: null,\r\n      add_device: false\r\n    }\r\n  }\r\n\r\n  handleBurger(e) {\r\n    console.log(\"burger\");\r\n  }\r\n\r\n  async handleChangeDevice(e) {\r\n    let device = null;\r\n    if (e.hasOwnProperty('target')) {\r\n      device = e.target.innerText.toLowerCase();\r\n    } else {\r\n      device = e.toLowerCase();\r\n    }\r\n    // Check if the target device is different\r\n    if (device === this.state.selected_device.description.toLowerCase()) return;\r\n    // Update new selected device\r\n    let new_selected_device = this.state.devices.filter(d => d.description.toLowerCase() === device);\r\n    // Retrieve data from device\r\n    if (new_selected_device.length !== 0) {\r\n      // Array.filter returns array - get first element in the array\r\n      new_selected_device = new_selected_device[0];\r\n      const data = await this.getDataLast24Hours(new_selected_device.serial);\r\n      this.setState({\r\n        selected_device: new_selected_device,\r\n        device_data: data\r\n      });\r\n    }\r\n  }\r\n\r\n  async getDataLast24Hours(serial) {\r\n    if (serial === undefined) return;\r\n    if (serial == null) return;\r\n    let start_date = new Date();\r\n    start_date.setDate(start_date.getDate() - 1);\r\n    let end_date = new Date();\r\n    end_date.setDate(end_date.getDate() + 1);\r\n\r\n    return getData(serial, start_date.toISOString(), end_date.toISOString());\r\n  }\r\n\r\n  async componentDidMount() {\r\n    document.addEventListener('DOMContentLoaded', function () {\r\n      var elems = document.querySelectorAll('.datepicker');\r\n      const options = {\r\n        defaultDate: new Date(),\r\n        setDefaultDate: true,\r\n      }\r\n      var instances = M.Datepicker.init(elems, options);\r\n    });\r\n    const devices = await getDevices();\r\n\r\n    this.setState({\r\n      devices: devices\r\n    });\r\n\r\n    if (this.state.devices !== undefined && this.state.devices !== null) {\r\n      this.setState({ selected_device: this.state.devices[0] })\r\n      const readings = await Promise.all(this.state.devices.map((device) => {\r\n        return getLastReading(device.serial);\r\n      }));\r\n      this.setState({\r\n        last_readings: readings\r\n      })\r\n\r\n      let start_date = new Date();\r\n      start_date.setDate(start_date.getDate() - 1);\r\n      let end_date = new Date();\r\n      end_date.setDate(end_date.getDate() + 1);\r\n      if (this.state.selected_device !== undefined) {\r\n        const data = await getData(this.state.selected_device.serial, start_date.toISOString(), end_date.toISOString());\r\n        if (data !== undefined) {\r\n          this.setState({ device_data: data });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  displayGraphs() {\r\n    if (this.state.device_data != null && this.state.device_data !== undefined) {\r\n      if (this.state.device_data.length === 0) {\r\n        // If no data is available display \"no data\"\r\n        return <h1 className=\"white-text center-align\">No Data</h1>\r\n      } else {\r\n        // Display a graph if data is available\r\n        return <Graph data={this.state.device_data} title={this.state.selected_device.description} />\r\n      }\r\n    }\r\n  }\r\n\r\n  displayCards() {\r\n    if (this.state.last_readings != null) {\r\n      return <Cards\r\n        selectedDevice={this.state.selected_device != null ? this.state.selected_device.description : null}\r\n        readings={this.state.last_readings}\r\n        devices={this.state.devices}\r\n        clickHandler={this.handleChangeDevice} />\r\n    }\r\n    else return null;\r\n  }\r\n\r\n  toggleAddDevice() {\r\n    const addDevice = this.state.add_device;\r\n    this.setState({ add_device: !addDevice });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div className=\"row margin-none\">\r\n          {/* Only show on mobile */}\r\n          <div className=\"hide hide-on-med-and-up center-align\">\r\n            <h1 className=\"white-text margin-none header-title\">Dashboard</h1>\r\n            <div className=\"burger\" onClick={this.handleBurger}>\r\n              <div></div>\r\n              <div></div>\r\n              <div></div>\r\n            </div>\r\n            <ul className=\"mobileNav\">\r\n              {this.state.devices != null ? this.state.devices.map(device => {\r\n                return <li key={device.serial}><button onClick={this.handleChangeDevice} className=\"waves-effect waves-light btn grey darken-2 sidebar-links\">{device.description}</button></li>\r\n              }) : null}\r\n              <li><button className=\"waves-effect waves-light btn grey darken-2 sidebar-links\"\r\n                onClick={this.toggleAddDevice}>{this.state.add_device ? \"Show Graphs\" : \"Add Device\"}</button></li>\r\n            </ul>\r\n          </div>\r\n          {/* End only show on mobile */}\r\n          {/* Sidebar - only display on tablets and larger screens */}\r\n          <div className=\"col s12 m4 l2 blue-grey darken-3 min-height-100 hide-on-med-and-down\">\r\n            <div className=\"section white-text text-center\">\r\n              <h1 className=\"white-text sidebar-title\">Graphs</h1>\r\n              <div className=\"divider\"></div>\r\n              <input type=\"text\" className=\"datepicker datepicker-override\"></input>\r\n              <ul>\r\n                {this.state.devices != null ? this.state.devices.map(device => {\r\n                  return <li key={device.serial}><button onClick={this.handleChangeDevice} className=\"waves-effect waves-light btn grey darken-2 sidebar-links\">{device.description}</button></li>\r\n                }) : null}\r\n                <div className=\"divider\"></div>\r\n                <li><button className=\"waves-effect waves-light btn green darken-4 sidebar-links\"\r\n                  onClick={this.toggleAddDevice}>{this.state.add_device ? \"Show Graphs\" : \"Add Device\"}</button></li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <div className=\"col s12 m12 l10 blue-grey darken-2 min-height-100vh\">\r\n            {this.displayCards()}\r\n            {this.state.add_device ?\r\n              <AddDevice />\r\n              :\r\n              this.displayGraphs()\r\n            }\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Container;","import './App.css';\r\n\r\nimport Container from './components/container';\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <Container />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}