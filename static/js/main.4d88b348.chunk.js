(this["webpackJsonphome-climate-monitor"]=this["webpackJsonphome-climate-monitor"]||[]).push([[0],{31:function(e,t,a){},32:function(e,t,a){},57:function(e,t,a){"use strict";a.r(t);var r=a(2),n=a.n(r),i=a(23),s=a.n(i),c=(a(31),a(32),a(1)),l=a.n(c),d=a(4),o=a(5),u=a(6),p=a(9),h=a(8),v=a(7),m=(a(34),a(24)),b=a.n(m),j=a(0),f=function(e){Object(h.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).handleClick=r.handleClick.bind(Object(p.a)(r)),r}return Object(u.a)(a,[{key:"handleClick",value:function(e){this.props.clickHandler(this.props.title)}},{key:"formatDate",value:function(e){var t=navigator.language;return new Intl.DateTimeFormat(t,{dateStyle:"short",timeStyle:"short",hour12:!1}).format(new Date(e))}},{key:"render",value:function(){return Object(j.jsx)("div",{className:"col s12 m5 l3",children:Object(j.jsx)("div",{className:"card card-pointer blue-grey ".concat(this.props.selected?"darken-3":"darken-4"),onClick:this.handleClick,children:Object(j.jsx)("div",{className:"card grey ".concat(this.props.selected?"darken-3":"darken-4"),children:Object(j.jsxs)("div",{className:"card-content white-text",children:[Object(j.jsx)("span",{className:"card-span",children:this.props.title?this.props.title:"Title"}),Object(j.jsx)("span",{className:"card-title",children:this.props.temperature?this.props.temperature+"\xb0C":"Temperature Error"}),Object(j.jsx)("p",{className:"card-span",children:this.props.humidity?this.props.humidity+"%":"Humdity Error"}),Object(j.jsx)("div",{className:"divider"}),Object(j.jsx)("span",{className:"card-span",children:this.props.date?this.formatDate(this.props.date):"Date Error"})]})})})})}}]),a}(r.Component),x=function(e){Object(h.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).getDeviceDescription=function(e){var t=r.props.devices.filter((function(t){return e===t.serial}));return 0!==t.length?t[0].description:""},r.deviceCard=function(){if(null!==r.props.readings&&void 0!==r.props.readings[0])return r.props.readings.map((function(e){return void 0!==e[0]?Object(j.jsx)(f,{title:r.getDeviceDescription(e[0].serial),humidity:e[0].humidity,temperature:e[0].temperature,date:e[0].timestamp,clickHandler:r.clickHandler,selected:r.props.selectedDevice===r.getDeviceDescription(e[0].serial)},e[0].serial):""}))},r.clickHandler=r.clickHandler.bind(Object(p.a)(r)),r}return Object(u.a)(a,[{key:"clickHandler",value:function(e){this.props.clickHandler(e)}},{key:"render",value:function(){return Object(j.jsx)("div",{className:"row",children:void 0!==this.props.devices?this.deviceCard():""})}}]),a}(r.Component),g=a(25),y=a.n(g),O=a(26),k=a.n(O)()(y.a),D=function(e){Object(h.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).state={labels:[],label:null,xData:[],yData:[],dateData:[],chartData:{},options:{}},r}return Object(u.a)(a,[{key:"getMinOfArray",value:function(e){return Math.min.apply(null,e)}},{key:"getMaxOfArray",value:function(e){return Math.max.apply(null,e)}},{key:"componentDidMount",value:function(){var e=Math.round(this.getMinOfArray(this.props.yDataLeft)-1),t=Math.round(this.getMaxOfArray(this.props.yDataLeft)+1),a=Math.round(this.getMinOfArray(this.props.yDataRight)-1),r=Math.round(this.getMaxOfArray(this.props.yDataRight)+1);this.setState({options:{color:"#FFF",elements:{point:{radius:0}},responsive:!0,scales:{y:{type:"linear",position:"left",grid:{color:"rgba(255, 255, 255, 0.1)"},min:e,max:t,ticks:{display:!0,stepSize:.5,color:"rgba(255, 255, 255, 0.7)"}},y1:{type:"linear",position:"right",grid:{drawOnChartArea:!1},min:a,max:r,ticks:{display:!0,stepSize:.5,color:"rgba(255, 255, 255, 0.7)"}},x:{grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{display:!0,color:"rgba(255, 255, 255, 0.7)"}}}}})}},{key:"render",value:function(){return Object(j.jsx)(k,{data:[{x:this.props.xData,y:this.props.yDataLeft,name:"Temperature",mode:"lines",hovertemplate:" %{y:.1f}&deg;C"},{x:this.props.xData,y:this.props.yDataRight,yaxis:"y2",name:"Humidity",mode:"lines",hovertemplate:" %{y:.0f}%"}],layout:{margin:{t:90,b:90,l:70,r:70,pad:10},autosize:!0,legend:{orientation:"h",yanchor:"bottom",y:1.12,xanchor:"right",x:1},xaxis:{title:{text:"Date/Time"},autorange:"false",type:"date"},yaxis:{title:"Temperature (&deg;C)",automargin:!0},yaxis2:{title:"Humidity (%)",range:[0,100],overlaying:"y",side:"right",automargin:!0},hovermode:"x unified"},useResizeHandler:!0,style:{maxWidth:"100%",height:"100%"}})}}]),a}(n.a.Component),w=function(e){Object(h.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(o.a)(this,a),r=t.call(this,e),Array.isArray(r.props.data)&&(r.state={data:r.props.data,temperatures:r.props.data.map((function(e){return e.temperature})),humidity:r.props.data.map((function(e){return e.humidity})),timestamps:r.props.data.map((function(e){return e.timestamp}))}),r}return Object(u.a)(a,[{key:"componentDidUpdate",value:function(e,t){if(e.data!==this.props.data&&Array.isArray(this.props.data)){var a=this.props.data.map((function(e){return e.temperature})),r=this.props.data.map((function(e){return e.humidity})),n=this.props.data.map((function(e){return e.timestamp}));this.setState({temperatures:a,humidity:r,timestamps:n})}}},{key:"render",value:function(){return Object(j.jsx)("div",{className:"row",children:Object(j.jsx)("div",{className:"col s12 m12 l12",children:Object(j.jsxs)("div",{className:"card blue-grey darken-1",children:[Object(j.jsx)("div",{className:"card-title white-text center-align hide-on-large-only",children:this.props.title}),Object(j.jsx)("div",{className:"card-content white-text",children:null!==this.state?Object(j.jsx)(D,{labelLeft:"Temperature (\u2103)",labelRight:"Humidity (%)",xData:this.state.timestamps,yDataLeft:this.state.temperatures,yDataRight:this.state.humidity,title:" "}):""})]})})})}}]),a}(r.Component),N=a(12),C=a.n(N),S="https://home-climate-monitor.herokuapp.com",_=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(S,"/device/"),e.next=3,M(t);case 3:return a=e.sent,e.abrupt("return",a.hasOwnProperty("data")?a.data:[]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function M(e){return H.apply(this,arguments)}function H(){return H=Object(d.a)(l.a.mark((function e(t){var a,r=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:4e3,e.prev=1,e.next=4,C()({method:"get",url:t,timeout:a});case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return","Error");case 10:case"end":return e.stop()}}),e,null,[[1,7]])}))),H.apply(this,arguments)}var A=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(S,"/data/").concat(t,"/last"),e.next=3,E(a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,i,s=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:new Date,r=s.length>2&&void 0!==s[2]?s[2]:new Date,n="".concat(S,"/data/").concat(t,"?start=").concat(a.replace("Z",""),"&end=").concat(r.replace("Z","")),e.next=5,E(n);case 5:return i=e.sent,e.abrupt("return",i.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function E(e){return T.apply(this,arguments)}function T(){return T=Object(d.a)(l.a.mark((function e(t){var a,r=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:4e3,e.prev=1,e.next=4,C()({method:"get",url:t,timeout:a});case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return","Error");case 10:case"end":return e.stop()}}),e,null,[[1,7]])}))),T.apply(this,arguments)}var I=function(e){Object(h.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).handleChangeDevice=r.handleChangeDevice.bind(Object(p.a)(r)),r.handleBurger=r.handleBurger.bind(Object(p.a)(r)),r.state={devices:null,last_readings:[],selected_device:null,device_data:null},r}return Object(u.a)(a,[{key:"handleBurger",value:function(e){console.log("burger")}},{key:"handleChangeDevice",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,(a=t.hasOwnProperty("target")?t.target.text:t)!==this.state.selected_device.description){e.next=4;break}return e.abrupt("return");case 4:if(0===(r=this.state.devices.filter((function(e){return e.description===a}))).length){e.next=11;break}return r=r[0],e.next=9,this.getDataLast24Hours(r.serial);case 9:n=e.sent,this.setState({selected_device:r,device_data:n});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDataLast24Hours",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(null!=t){e.next=4;break}return e.abrupt("return");case 4:return(a=new Date).setDate(a.getDate()-1),(r=new Date).setDate(r.getDate()+1),e.abrupt("return",L(t,a.toISOString(),r.toISOString()));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,n,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".datepicker"),t={defaultDate:new Date,setDefaultDate:!0};b.a.Datepicker.init(e,t)})),e.next=3,_();case 3:if(t=e.sent,this.setState({devices:t}),void 0===this.state.devices){e.next=20;break}return this.setState({selected_device:this.state.devices[0]}),e.next=9,Promise.all(this.state.devices.map((function(e){return A(e.serial)})));case 9:if(a=e.sent,this.setState({last_readings:a}),(r=new Date).setDate(r.getDate()-1),(n=new Date).setDate(n.getDate()+1),void 0===this.state.selected_device){e.next=20;break}return e.next=18,L(this.state.selected_device.serial,r.toISOString(),n.toISOString());case 18:void 0!==(i=e.sent)&&this.setState({device_data:i});case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(j.jsx)("div",{children:Object(j.jsxs)("div",{className:"row margin-none",children:[Object(j.jsxs)("div",{className:"hide hide-on-med-and-up center-align",children:[Object(j.jsx)("h1",{className:"white-text margin-none header-title",children:"Dashboard"}),Object(j.jsxs)("div",{className:"burger",onClick:this.handleBurger,children:[Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{})]}),Object(j.jsx)("ul",{className:"mobileNav",children:null!=this.state.devices?this.state.devices.map((function(t){return Object(j.jsx)("li",{children:Object(j.jsx)("a",{onClick:e.handleChangeDevice,className:"waves-effect waves-light btn grey darken-2 sidebar-links",children:t.description})},t.serial)})):""})]}),Object(j.jsx)("div",{className:"col s12 m4 l2 blue-grey darken-3 min-height-100 hide-on-med-and-down",children:Object(j.jsxs)("div",{className:"section white-text text-center",children:[Object(j.jsx)("h1",{className:"white-text sidebar-title",children:"Graphs"}),Object(j.jsx)("div",{className:"divider"}),Object(j.jsx)("input",{type:"text",className:"datepicker datepicker-override"}),Object(j.jsx)("ul",{children:null!=this.state.devices?this.state.devices.map((function(t){return Object(j.jsx)("li",{children:Object(j.jsx)("a",{onClick:e.handleChangeDevice,className:"waves-effect waves-light btn grey darken-2 sidebar-links",children:t.description})},t.serial)})):""})]})}),Object(j.jsxs)("div",{className:"col s12 m12 l10 blue-grey darken-2 min-height-100vh",children:[null!=this.state.last_readings?Object(j.jsx)(x,{selectedDevice:null!=this.state.selected_device?this.state.selected_device.description:null,readings:this.state.last_readings,devices:this.state.devices,clickHandler:this.handleChangeDevice}):"",null!=this.state.device_data&&void 0!==this.state.device_data&&this.state.device_data.length>1?Object(j.jsx)(w,{data:this.state.device_data,title:this.state.selected_device.description}):""]})]})})}}]),a}(r.Component),R=I;var B=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(R,{})})};s.a.render(Object(j.jsx)(n.a.StrictMode,{children:Object(j.jsx)(B,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.4d88b348.chunk.js.map